<?php

/**
 * EiScenarioPackageTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class EiScenarioPackageTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object EiScenarioPackageTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('EiScenarioPackage');
    }
    /* Récupération de la liaison entre une intervention et la version par défaut d'un scénario */
    public function getDefaultInterventionWithScenarioVersion( EiProjet $ei_project ,EiVersion $ei_version, Doctrine_Connection $conn = null){
        if($conn==null) $conn = Doctrine_Manager::connection();   
        return $conn->fetchRow("select sp.*, s.id as subject_id ,s.name as subject_name from ei_scenario_package sp
                                inner join ei_subject s on sp.package_id= s.package_id and sp.package_ref=s.package_ref
                                where sp.ei_scenario_id= ".$ei_version->getEiScenarioId()." and sp.ei_version_id=".$ei_version->getId().
                                " and s.project_id=".$ei_project->getProjectId()." and s.project_ref=".$ei_project->getRefId());
    }
}