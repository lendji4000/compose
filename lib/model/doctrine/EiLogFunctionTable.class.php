<?php

/**
 * EiLogFunctionTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class EiLogFunctionTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object EiLogFunctionTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('EiLogFunction');
    }
    public function getLastScenarioExecution(EiProjet $ei_project,EiScenario $ei_scenario=null){ 
        $q= Doctrine_Query::create()->from('EiLogFunction elf ')
                ->where('EiScenario.id=elf.ei_scenario_id')
                ->andWhere(" EiScenario.project_ref=? And   EiScenario.project_id=?",array(
                    $ei_project->getRefId(),$ei_project->getProjectId()
                ));
        if($ei_scenario!=null):
            $q=$q->andWhere('EiScenario.id='.$ei_scenario->getId());
        endif;
        return $q->orderBy('elf.date_debut DESC')
                ->limit(1) ;
    }
}